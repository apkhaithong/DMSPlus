<div class="row" id="spy2">
    <!-- Chart with filter Widget -->
    <div class="col-md-12 admin-grid">
        <div class="panel" id="p2">
            <div class="panel-heading">
                <span class="panel-icon"><span class="glyphicons glyphicons-car"></span></span>
                <span class="panel-title">สอบถามรายละเอียดสินค้า</span>
                <span class="panel-controls">
                    <a href="#" class="panel-control-loader"></a>
                    <a href="#" class="panel-control-remove"></a>
                    <a href="#" class="panel-control-collapse"></a>
                    <a href="#" class="panel-control-fullscreen"></a>
                </span>
            </div>
            <div class="panel-body">
                <form class="form-horizontal" id="fmLocatparking">
                    <div class="p15 pt5 mt15">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-sm-4 control-label required" for="schStrno">ค้นหาตามเลขตัวถัง</label>
                                    <div class="col-sm-8">
                                        <div class="bs-component">
                                            <div id="schStrno" class="input-button">
                                                <input type="text" id="v-schStrno" />
                                                <div id="searchStrno"><img alt="search" width="20" height="20" src="/images/search_lg.png" /></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="row">
                                    <div class="col-md-4">
                                        <button type="button" class="btn btn-rounded btn-dark btn-block" id="btnQuery">
                                            <i class="glyphicons glyphicons-inbox_in"></i>&nbsp;
                                            แสดงข้อมูล
                                        </button>
                                    </div>
                                    <div class="col-md-8"></div>
                                </div>
                            </div>
                            <div class="col-md-4">

                            </div>
                        </div>
                        <hr class="short alt">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-md-4 control-label" for="strno">เลขตัวถัง</label>
                                    <div class="col-md-8">
                                        <div class="bs-component">
                                            <input type="text" id="strno" class="text-desc" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-md-4 control-label" for="engno">เลขเครื่องยนต์</label>
                                    <div class="col-md-8">
                                        <div class="bs-component">
                                            <input type="text" id="engno" class="text-desc" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-md-4 control-label" for="typecod">ยี่ห้อสินค้า</label>
                                    <div class="col-md-8">
                                        <div class="bs-component">
                                            <input type="text" id="typecod" class="text-desc" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-md-4 control-label" for="modelcod">รุ่นสินค้า</label>
                                    <div class="col-md-8">
                                        <div class="bs-component">
                                            <input type="text" id="modelcod" class="text-desc" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-md-4 control-label" for="baabcod">แบบสินค้า</label>
                                    <div class="col-md-8">
                                        <div class="bs-component">
                                            <input type="text" id="baabcod" class="text-desc" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-md-4 control-label" for="colorcod">สีสินค้า</label>
                                    <div class="col-md-8">
                                        <div class="bs-component">
                                            <input type="text" id="colorcod" class="text-desc" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-md-4 control-label" for="cc">ขนาด ซี ซี</label>
                                    <div class="col-md-8">
                                        <div class="bs-component">
                                            <input type="text" id="cc" class="text-desc" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label class="col-md-4 control-label" for="gcode">กลุ่มสินค้า</label>
                                    <div class="col-md-8">
                                        <div class="bs-component">
                                            <input type="text" id="gcode" class="text-desc" readonly/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                            </div>
                        </div>
                        <hr class="short alt">
                        <div class="row">
                            <div class="col-md-12">
                                <div id="gridStock"></div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- end: .col-md-12.admin-grid -->
</div>
<!-- end: .row -->
<script type="text/javascript">
    $(document).ready(function () {
        $('.admin-panels').adminpanel({
            grid: '.admin-grid',
            callback: function () {
                bootbox.confirm('<h3>A Custom Callback!</h3>', function () {});
            },
            onFinish: function () {
                $('.admin-panels').addClass('animated fadeIn').removeClass('fade-onload');
                demoHighCharts.init();
            },
            onSave: function () {
                $(window).trigger('resize');
            }
        });

        function getDesc(strno) {
            $.ajax({
                async: false,
                method: 'GET',
                dataType: 'json',
                url: "sqltext",
                data: {
                    sql: "SELECT STRNO, ENGNO, TYPECOD, MODELCOD, BAABCOD, COLORCOD, CC, GCODE FROM INVTRAN WHERE STRNO = '" + strno + "' "
                },
                success: function(data) {
                    $('#strno').val(data[0].STRNO);
                    $('#engno').val(data[0].ENGNO);
                    $('#typecod').val(data[0].TYPECOD);
                    $('#modelcod').val(data[0].MODELCOD);
                    $('#baabcod').val(data[0].BAABCOD);
                    $('#colorcod').val(data[0].COLORCOD);
                    $('#cc').val(data[0].CC);
                    $('#gcode').val(data[0].GCODE);
                }
            });
        }

        var emptyStock = [];
        var sourceStock = {
            datatype: "json",
            datafields: [{
                    name: 'LOCAT',
                    type: 'string'
                },
                {
                    name: 'REFNOIN',
                    type: 'string'
                },
                {
                    name: 'REFDTIN',
                    type: 'date'
                },
                {
                    name: 'INDESC',
                    type: 'string'
                },
                {
                    name: 'REFNOOUT',
                    type: 'string'
                },
                {
                    name: 'REFDTOUT',
                    type: 'date'
                },
                {
                    name: 'OUTDESC',
                    type: 'string'
                },
                {
                    name: 'FLAG',
                    type: 'string'
                },
                {
                    name: 'CRCOST',
                    type: 'float'
                },
                {
                    name: 'DISCT',
                    type: 'float'
                },
                {
                    name: 'NETCOST',
                    type: 'float'
                },
                {
                    name: 'CRVAT',
                    type: 'float'
                },
                {
                    name: 'TOTCOST',
                    type: 'float'
                },
                {
                    name: 'STDPRC',
                    type: 'float'
                },
                {
                    name: 'NETTAXBUY',
                    type: 'float'
                },
                {
                    name: 'VATTAXBUY',
                    type: 'float'
                },
                {
                    name: 'TOTTAXBUY',
                    type: 'float'
                },
                {
                    name: 'LOCATPARK',
                    type: 'string'
                }
            ],
            localdata: emptyStock
        };
        // create Data Adapter
        var dataStock = new $.jqx.dataAdapter(sourceStock);
        // create jqxInput widget.
        $('#schStrno').jqxInput({
            height: 25,
            width: '100%'
        });
        $("#strno").jqxInput({
            height: 25,
            width: '100%',
            maxLength: 20
        });
        $('#engno').jqxInput({
            height: 25,
            width: '100%'
        });
        $('#typecod').jqxInput({
            height: 25,
            width: '100%'
        });
        $('#modelcod').jqxInput({
            height: 25,
            width: '100%'
        });
        $('#baabcod').jqxInput({
            height: 25,
            width: '100%'
        });
        $('#colorcod').jqxInput({
            height: 25,
            width: '100%'
        });
        $('#cc').jqxInput({
            height: 25,
            width: '100%'
        });
        $('#gcode').jqxInput({
            height: 25,
            width: '100%'
        });
        // create jqxGrid widget.
        $("#gridStock").jqxGrid({
            width: '100%',
            height: 300,
            source: dataStock,
            sortable: true,
            columnsresize: true,
            filterable: true,
            showfilterrow: true,
            showaggregates: true,
            showstatusbar: false,
            statusbarheight: 25,
            pageable: false,
            pagesize: 20,
            pagermode: "simple",
            columns: [{
                    text: 'สาขา',
                    datafield: 'LOCAT',
                    width: 60,
                    align: 'center',
                    filtertype: 'checkedlist'
                },
                {
                    text: 'เลขที่รับเข้าสต็อก',
                    datafield: 'REFNOIN',
                    width: 100,
                    align: 'center',
                    filtertype: 'checkedlist'
                },
                {
                    text: 'วันที่รับเข้าสต็อก',
                    datafield: 'REFDTIN',
                    width: 100,
                    align: 'center',
                    columntype: 'datetimeinput',
                    cellsformat: 'dd/MM/yyyy',
                    filtertype: 'range'
                },
                {
                    text: 'เข้าสต็อกโดย',
                    datafield: 'INDESC',
                    width: 100,
                    align: 'center',
                    filtertype: 'checkedlist'
                },
                {
                    text: 'เลขที่ตัดสต็อก',
                    datafield: 'REFNOOUT',
                    width: 100,
                    align: 'center',
                    filtertype: 'checkedlist'
                },
                {
                    text: 'วันที่ตัดสต็อก',
                    datafield: 'REFDTOUT',
                    width: 100,
                    align: 'center',
                    columntype: 'datetimeinput',
                    cellsformat: 'dd/MM/yyyy',
                    filtertype: 'range'
                },
                {
                    text: 'ตัดสต็อกโดย',
                    datafield: 'OUTDESC',
                    width: 100,
                    align: 'center',
                    filtertype: 'checkedlist'
                },
                {
                    text: 'สถานะ',
                    datafield: 'FLAG',
                    width: 70,
                    align: 'center',
                    filtertype: 'checkedlist'
                },
                {
                    text: 'มูลค่าทุน',
                    datafield: 'CRCOST',
                    width: 100,
                    align: 'center',
                    cellsalign: 'right',
                    cellsformat: 'd2',
                    filtertype: 'number'
                },
                {
                    text: 'ส่วนลด',
                    datafield: 'DISCT',
                    width: 80,
                    align: 'center',
                    cellsalign: 'right',
                    cellsformat: 'd2',
                    filtertype: 'number'
                },
                {
                    text: 'ทุนสุทธิ',
                    datafield: 'NETCOST',
                    width: 100,
                    align: 'center',
                    cellsalign: 'right',
                    cellsformat: 'd2',
                    filtertype: 'number'
                },
                {
                    text: 'ภาษี',
                    datafield: 'CRVAT',
                    width: 100,
                    align: 'center',
                    cellsalign: 'right',
                    cellsformat: 'd2',
                    filtertype: 'number'
                },
                {
                    text: 'ทุนรวมภาษี',
                    datafield: 'TOTCOST',
                    width: 100,
                    align: 'center',
                    cellsalign: 'right',
                    cellsformat: 'd2',
                    filtertype: 'number'
                },
                {
                    text: 'มูลค่าลดหนี้ซื้อ',
                    datafield: 'NETTAXBUY',
                    width: 100,
                    align: 'center',
                    cellsalign: 'right',
                    cellsformat: 'd2',
                    filtertype: 'number'
                },
                {
                    text: 'ภาษีลดหนี้ซื้อ',
                    datafield: 'VATTAXBUY',
                    width: 100,
                    align: 'center',
                    cellsalign: 'right',
                    cellsformat: 'd2',
                    filtertype: 'number'
                },
                {
                    text: 'ยอดรวมลดหนี้ซื้อ',
                    datafield: 'TOTTAXBUY',
                    width: 100,
                    align: 'center',
                    cellsalign: 'right',
                    cellsformat: 'd2',
                    filtertype: 'number'
                },
                {
                    text: 'สถานที่จอด',
                    datafield: 'LOCATPARK',
                    width: 100,
                    align: 'center',
                    filtertype: 'checkedlist'
                }
            ]
        });
        // On Click
        $("#btnQuery").off().on('click', function () {
            if ($("#schStrno").val() === '') {
                ShowMessage("กรุณาระบุเลขตัวถัง! ", "danger");
            } else {
                $("#jqxLoader").jqxLoader('open');
                // Get Data
                $.ajax({
                    async: true,
                    method: 'GET',
                    dataType: 'json',
                    url: "sqltext",
                    data: {
                        sql: "SELECT * FROM  STKCARD  WHERE STRNO ='"+$("#schStrno").val()+"' ORDER BY REFDTIN"
                    },
                    success: function (data) {
                        sourceStock.localdata = data;
                        getDesc($("#schStrno").val());
                        $("#gridStock").jqxGrid('updatebounddata');
                        $("#jqxLoader").jqxLoader('close');
                    }
                });
            }
        });
        // Search
        $("#searchStrno").off().on('click', function () {
            searchAll('strnoAll', 'schStrno');
        });
    });
</script>